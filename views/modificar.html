<section class="uk-section custom-wrapper">
    <div class="uk-card uk-card-default uk-card-body
        uk-width-1-2@m uk-align-center">
        <form method="post" action="/tarea/{{ tarea._id}}/modificar"
              encType="multipart/form-data">

            <fieldset class="uk-fieldset">

                <legend class="uk-legend">Modificar tarea</legend>

                <div class="uk-margin">
                    <label class="uk-form-label">Título</label>
                    <input class="uk-input" type="text" name="titulo"
                           value="{{tarea.titulo}}" required="true">
                </div>

                <div class="uk-grid uk-margin">
                    <div class="uk-width-2-5">
                        <label class="uk-form-label">Seleccionar operario</label><br>
                        <div>
                            <select class="uk-select uk-width-3-5" name="operario" id="operario"
                                    required="true">
                                {{#each operarios}}
                                <option value="{{nombre}}">{{nombre}}</option>
                                {{/each}}
                            </select>
                            <button id="add" style="padding: 0 8px;" class="uk-button uk-button-primary uk-border-rounded" type="button">
                                <span uk-icon="icon: plus-circle"></span>
                            </button>
                            <button id="remove" style="padding: 0 8px;" class="uk-button uk-button-danger uk-border-rounded" type="button">
                                <span uk-icon="icon: minus-circle"></span>
                            </button>
                        </div>
                    </div>
                    <div class="uk-width-3-5">
                        <label class="uk-form-label">Operario/s asignado/s</label>
                        <input class="uk-input" type="text" readonly id="operarios-asignados"
                               name="operariosasignados" value="{{tarea.asignados}}" required="true">
                    </div>
                </div>

                <script>
                    var operariosstr = "{{tarea.asignados}}"
                    var operarios = operariosstr.split(",")

                    $("#add").click(function () {
                        for( var i = 0; i < operarios.length; i++){
                            if ( operarios[i] === $("#operario").val()) {
                                return
                            }
                        }
                        operarios.push($("#operario").val())
                        $("#operarios-asignados").val(operarios)
                    })

                    $("#remove").click(function () {
                        for( var i = 0; i < operarios.length; i++){
                            if ( operarios[i] === $("#operario").val()) {
                                operarios.splice(i, 1);
                            }
                        }
                        $("#operarios-asignados").val(operarios)
                    })
                </script>

                <div class="uk-grid uk-margin">
                    <div class="uk-width-1-3">
                        <label class="uk-form-label">
                            Fecha límite
                        </label>
                        <input class="uk-input" type="number"
                               name="dia" id="dia"
                               placeholder="Día"
                               required="true">
                    </div>
                    <div class="uk-width-1-3">
                        <label class="uk-form-label"> &nbsp;
                        </label>
                        <select class="uk-select" name="mes" id="mes"
                                required="true">
                            <option value="" disabled selected>Mes</option>
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="uk-width-1-3">
                        <label class="uk-form-label"> &nbsp;
                        </label>
                        <input class="uk-input" type="number"
                               name="año" id="año"
                               placeholder="Año"
                               required="true">
                    </div>
                </div>

                <script>
                    var fecha = "{{tarea.limite}}"
                    var valores = fecha.split("/")
                    $("#dia").val(valores[0])
                    $("#mes").val(valores[1])
                    $("#año").val(valores[2])
                </script>

                <div class="uk-margin">
                    <label class="uk-form-label">Descripción</label>
                    <textarea class="uk-textarea" rows="5"
                              name="descripcion"
                              required="true">{{tarea.descripcion}}</textarea>
                </div>

                <button class="uk-button uk-button-primary uk-width-1-1
                        uk-margin-small-bottom"
                        type="submit">
                    Modificar
                </button>
            </fieldset>
        </form>
    </div>
</section>
